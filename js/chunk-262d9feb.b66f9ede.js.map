{"version":3,"sources":["webpack:///./src/components/AlertIndicator.vue?a996","webpack:///./src/components/AlertIndicator.vue?90ad","webpack:///src/components/AlertIndicator.vue","webpack:///./src/components/AlertIndicator.vue?ed20","webpack:///./src/components/AlertIndicator.vue?e61a"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","$event","selectAsi","style","severityColor","maxSeverity","_v","_s","title","isDark","attrs","_l","$config","indicators","severity","key","counts","_e","staticRenderFns","props","type","String","default","query","data","computed","$store","getters","getPreference","refresh","state","refreshInterval","watch","val","getMostSevere","getCounts","created","cancelTimer","refreshCounts","beforeDestroy","methods","setSearch","URLSearchParams","setFilter","refreshList","dispatch","environment","filter","get","text","status","has","getAll","customer","service","group","getConfig","paramsWithOpenStatus","append","response","severityCounts","sev","setTimeout","timer","clearTimeout","component","VCard","VCardActions","VCardText","VFlex","VLayout"],"mappings":"kHAAA,W,gECAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,SAAS,CAACE,YAAY,kBAAkBC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,eAAe,CAACL,EAAG,cAAc,CAACE,YAAY,OAAOI,MAAM,CAAG,mBAAoBV,EAAIW,cAAcX,EAAIY,eAAiB,CAACR,EAAG,MAAM,CAACE,YAAY,sCAAsC,CAACN,EAAIa,GAAG,IAAIb,EAAIc,GAAGd,EAAIe,OAAO,SAASX,EAAG,iBAAiB,CAACE,YAAY,YAAYI,MAAM,CAAG,mBAAoBV,EAAIgB,OAAS,GAAK,YAAc,CAACZ,EAAG,WAAW,CAACA,EAAG,SAAS,CAACA,EAAG,MAAM,CAACE,YAAY,oBAAoB,CAAEN,EAAU,OAAEI,EAAG,WAAW,CAACa,MAAM,CAAC,cAAc,GAAG,wBAAwB,KAAKjB,EAAIkB,GAAIlB,EAAImB,QAAQC,WAAmB,UAAE,SAASC,GAAU,OAAOjB,EAAG,MAAM,CAACkB,IAAID,EAASf,YAAY,4BAA4BI,MAAM,CAAG,mBAAoBV,EAAIW,cAAcU,KAAc,CAACrB,EAAIa,GAAG,IAAIb,EAAIc,GAAGd,EAAIuB,OAAOF,IAAa,GAAG,UAAS,GAAGrB,EAAIwB,MAAM,MAAM,IAAI,IAAI,IACh6BC,EAAkB,G,kECgDtB,GACEC,MAAO,CACLX,MAAO,CACLY,KAAMC,OACNC,QAAS,IAEXC,MAAO,CACLH,KAAM,CAAC,OAAb,cACME,QAAS,KAGbE,KAAM,WAAR,OACA,YACA,gBACA,iBACA,aAEEC,SAAU,CACRhB,OADJ,WAEM,OAAOf,KAAKgC,OAAOC,QAAQC,cAAc,WAE3CC,QAJJ,WAKM,OAAOnC,KAAKgC,OAAOI,MAAMD,SAE3BE,gBAPJ,WAQM,OACN,sDACA,oDAIEC,MAAO,CACLH,QADJ,SACA,GACUI,IACFvC,KAAKwC,gBACLxC,KAAKyC,eAIXC,QAvCF,WAwCI1C,KAAK2C,cACL3C,KAAK4C,iBAEPC,cA3CF,WA4CI7C,KAAK2C,eAEPG,QAAS,CACPtC,UADJ,WAEMR,KAAK+C,UAAU,IAAIC,gBAAgBhD,KAAK6B,QACxC7B,KAAKiD,UAAU,IAAID,gBAAgBhD,KAAK6B,QACxC7B,KAAKkD,eAEPH,UANJ,SAMA,GACM/C,KAAKgC,OAAOmB,SAAS,qBAAsBtB,IAE7CoB,UATJ,SASA,GACMjD,KAAKgC,OAAOmB,SAAS,mBAAoB,CACvCC,YAAaC,EAAOC,IAAI,eACxBC,KAAMF,EAAOC,IAAI,QACjBE,OAAQH,EAAOI,IAAI,UAAYJ,EAAOK,OAAO,UAAY,KACzDC,SAAUN,EAAOI,IAAI,YAAcJ,EAAOK,OAAO,YAAc,KAC/DE,QAASP,EAAOI,IAAI,WAAaJ,EAAOK,OAAO,WAAa,KAC5DG,MAAOR,EAAOI,IAAI,SAAWJ,EAAOK,OAAO,SAAW,QAG1DhD,cAnBJ,SAmBA,GACM,OAAOV,KAAKsB,QAAUtB,KAAKsB,OAAOF,GAAY,EAAIpB,KAAKgC,OAAOC,QAAQ6B,UAAU,UAAU1C,SAASA,GAAY,eAEjHqB,UAtBJ,WAsBA,WACM,OAAO,EAAb,gDACA,kBAAQ,OAAR,8BAEID,cA1BJ,WA0BA,WACA,kCACMuB,EAAqBC,OAAO,SAAU,QAEtC,EAAN,kBACA,kBACQ,EAAR,2DADQ,IAAR,mBAEA,+BAFQ,IAEE,IAAK,EAAf,oCACY,GAAIC,EAASC,eAAeC,GAAO,EAAG,CACpC,EAAd,cACc,QALd,mCAUIvB,cAzCJ,WAyCA,WACM5C,KAAKwC,gBACLxC,KAAKyC,YACX,iBAAQ,OAAR,iFAEIS,YA9CJ,WA8CA,WACMlD,KAAKgC,OAAOmB,SAAS,MAAO,CAAC,WAAW,IACxCiB,YAAW,WACT,EAAR,wCACA,MAEIzB,YApDJ,WAqDU3C,KAAKqE,QACPC,aAAatE,KAAKqE,OAClBrE,KAAKqE,MAAQ,SCtJmU,I,6FCQpVE,EAAY,eACd,EACAzE,EACA0B,GACA,EACA,KACA,WACA,MAIa,aAAA+C,EAAiB,QAShC,IAAkBA,EAAW,CAACC,QAAA,KAAMC,aAAA,OAAaC,UAAA,OAAUC,QAAA,KAAMC,UAAA","file":"js/chunk-262d9feb.b66f9ede.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertIndicator.vue?vue&type=style&index=0&id=2fffb3c6&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{staticClass:\"alert-indicator\",on:{\"click\":function($event){return _vm.selectAsi()}}},[_c('v-card-text',{staticClass:\"pa-0\",style:({ 'background-color': _vm.severityColor(_vm.maxSeverity) })},[_c('div',{staticClass:\"text-uppercase text-xs-center py-2\"},[_vm._v(\" \"+_vm._s(_vm.title)+\" \")])]),_c('v-card-actions',{staticClass:\"pa-0 mx-0\",style:({ 'background-color': _vm.isDark ? '' : '#F5F5F5' })},[_c('v-layout',[_c('v-flex',[_c('div',{staticClass:\"counts-container\"},[(_vm.counts)?_c('v-layout',{attrs:{\"align-start\":\"\",\"justify-space-between\":\"\"}},_vm._l((_vm.$config.indicators.severity),function(severity){return _c('div',{key:severity,staticClass:\"count text-xs-center py-2\",style:({ 'background-color': _vm.severityColor(severity) })},[_vm._v(\" \"+_vm._s(_vm.counts[severity] || 0)+\" \")])}),0):_vm._e()],1)])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-card\n    class=\"alert-indicator\"\n    @click=\"selectAsi()\"\n  >\n    <v-card-text\n      class=\"pa-0\"\n      :style=\"{ 'background-color': severityColor(maxSeverity) }\"\n    >\n      <div\n        class=\"text-uppercase text-xs-center py-2\"\n      >\n        {{ title }}\n      </div>\n    </v-card-text>\n\n    <v-card-actions\n      class=\"pa-0 mx-0\"\n      :style=\"{ 'background-color': isDark ? '' : '#F5F5F5' }\"\n    >\n      <v-layout>\n        <v-flex>\n          <div\n            class=\"counts-container\"\n          >\n            <v-layout\n              v-if=\"counts\"\n              align-start\n              justify-space-between\n            >\n              <div\n                v-for=\"severity in $config.indicators.severity\"\n                :key=\"severity\"\n                class=\"count text-xs-center py-2\"\n                :style=\"{ 'background-color': severityColor(severity) }\"\n              >\n                {{ counts[severity] || 0 }}\n              </div>\n            </v-layout>\n          </div>\n        </v-flex>\n      </v-layout>\n    </v-card-actions>\n  </v-card>\n</template>\n\n<script>\nimport AlertsApi from '../services/api/alert.service'\n\nexport default {\n  props: {\n    title: {\n      type: String,\n      default: ''\n    },\n    query: {\n      type: [ String, Array, Object ],  // URLSearchParams\n      default: ''\n    }\n  },\n  data: () => ({\n    counts: null,\n    openCounts: null,\n    maxSeverity: null,\n    timer: null\n  }),\n  computed: {\n    isDark() {\n      return this.$store.getters.getPreference('isDark')\n    },\n    refresh() {\n      return this.$store.state.refresh\n    },\n    refreshInterval() {\n      return (\n        this.$store.getters.getPreference('refreshInterval') ||\n        this.$store.getters.getConfig('refresh_interval')\n      )\n    }\n  },\n  watch: {\n    refresh(val) {\n      if (val) {\n        this.getMostSevere()\n        this.getCounts()\n      }\n    }\n  },\n  created() {\n    this.cancelTimer()\n    this.refreshCounts()\n  },\n  beforeDestroy() {\n    this.cancelTimer()\n  },\n  methods: {\n    selectAsi() {\n      this.setSearch(new URLSearchParams(this.query))\n      this.setFilter(new URLSearchParams(this.query))\n      this.refreshList()\n    },\n    setSearch(query) {\n      this.$store.dispatch('alerts/updateQuery', query)\n    },\n    setFilter(filter) {\n      this.$store.dispatch('alerts/setFilter', {\n        environment: filter.get('environment'),\n        text: filter.get('text'),\n        status: filter.has('status') ? filter.getAll('status') : null,\n        customer: filter.has('customer') ? filter.getAll('customer') : null,\n        service: filter.has('service') ? filter.getAll('service') : null,\n        group: filter.has('group') ? filter.getAll('group') : null\n      })\n    },\n    severityColor(severity) {\n      return this.counts && this.counts[severity] > 0 ? this.$store.getters.getConfig('colors').severity[severity] : 'transparent'\n    },\n    getCounts() {\n      return AlertsApi.getCounts(new URLSearchParams(this.query))\n        .then(response => (this.counts = response.severityCounts))\n    },\n    getMostSevere() {\n      let paramsWithOpenStatus = new URLSearchParams(this.query)\n      paramsWithOpenStatus.append('status', 'open')\n\n      AlertsApi.getCounts(paramsWithOpenStatus)\n        .then(response => {\n          this.maxSeverity = this.$config.alarm_model.defaults.normal_severity\n          for (let sev of this.$config.indicators.severity) {\n            if (response.severityCounts[sev] > 0) {\n              this.maxSeverity = sev\n              break\n            }\n          }\n        })\n    },\n    refreshCounts() {\n      this.getMostSevere()\n      this.getCounts()\n        .then(() => this.timer = setTimeout(() => this.refreshCounts(), this.refreshInterval))\n    },\n    refreshList() {\n      this.$store.dispatch('set', ['refresh', true])\n      setTimeout(() => {\n        this.$store.dispatch('set', ['refresh', false])\n      }, 300)\n    },\n    cancelTimer() {\n      if (this.timer) {\n        clearTimeout(this.timer)\n        this.timer = null\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.alert-indicator .v-card__text div {\n  height: 34px;\n  font-weight: bold;\n  font-family: 'Sintony', sans-serif;\n  font-size: 14px;\n  vertical-align: middle;\n}\n.alert-indicator .v-card__actions div {\n  height: 34px;\n  font-family: 'Sintony', sans-serif;\n  font-size: 14px;\n  vertical-align: middle;\n}\n\n.count {\n  min-width: 16%;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertIndicator.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AlertIndicator.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AlertIndicator.vue?vue&type=template&id=2fffb3c6&scoped=true&\"\nimport script from \"./AlertIndicator.vue?vue&type=script&lang=js&\"\nexport * from \"./AlertIndicator.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AlertIndicator.vue?vue&type=style&index=0&id=2fffb3c6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2fffb3c6\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VFlex } from 'vuetify/lib/components/VGrid';\nimport { VLayout } from 'vuetify/lib/components/VGrid';\ninstallComponents(component, {VCard,VCardActions,VCardText,VFlex,VLayout})\n"],"sourceRoot":""}